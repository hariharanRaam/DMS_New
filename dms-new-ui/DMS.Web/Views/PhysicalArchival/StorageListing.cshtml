@using Kendo.Mvc.UI;
@using Kendo.Mvc.UI.Fluent;
@using Kendo.Mvc.Extensions;
@model DMS.Model.BasicReport_Model
@{
    Layout = "~/Views/Shared/_LayoutNew.cshtml";
}
<!DOCTYPE html>
<style>
    .col-md-12 {
        padding-left: 0px !important;
    }

    .accordion_container {
        width: 100%;
    }

    .accordion_head {
        background-color: #337ab7;
        color: white;
        cursor: pointer;
        font-family: arial;
        font-size: 14px;
        margin: 0 0 1px 0;
        padding: 1px 3px;
        font-weight: bold;
    }

    .accordion_body p {
        padding: 18px 5px;
        margin: 0px;
    }

    .plusminus {
        float: right;
    }

    .ioniconplus {
        width: 15px;
        background-image: url('../images/minus-circled.png');
        background-repeat: no-repeat;
        background-position: -50px -128px;
        display: inline-block;
        cursor: pointer;
    }

    /*.ob-right {
        text-align: right;
    }*/
    .gj-unselectable {
        margin-left: -10%;
        overflow-y: auto !important;
        height: 500px;
    }

    .cus-lbl {
        font-weight: normal;
    }

    .panel-default {
        border-color: #337ab7 !important;
    }

    .panel {
        background-color: none;
    }

    /* .form-control {
        height: 20px !important;
        width: 90% !important;
    }*/

    /*div#kwindow_Filter {
        overflow: hidden;
    }*/

    .foo {
        outline: 1px solid #337ab7;
    }

    /*.k-grid .k-grid-header .k-header .k-link {
        overflow: visible !important;
    }*/

    .foo .componentTitle {
        position: absolute;
        top: -25px;
        background: #fff;
        padding: 0 10px;
    }

 .k-dropdown-wrap.k-state-default{
            background-clip: padding-box;
           
    display: block;
    height:90%;
    width:initial;
    padding: 0.4375rem 1.875rem 0.4375rem 0.875rem;
    -moz-padding-start: calc(0.875rem - 3px);
    font-size: 0.7075rem;
    font-weight: 400;
    line-height: 1.15;
    color: #697a8d;
    background-color: #fff;
    background-repeat: no-repeat;
    background-position: right 0.875rem center;
    background-size: 17px 12px;
    border: 1px solid #d9dee3;
    border-radius: 0.375rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    -webkit-appearance: none;
    -moz-appearance: none;
}
        .k-item{
             background-color: #fff;
             background-position: right 0.875rem center;
             
             
        }
        .k-content{
            width:100%;
        }
        /*.k-button{
             background-color: transparent;
              color: blue;
              border: aliceblue;

        }*/
        .k-grid{
             color: #697a8d;
    background-color: #fff;
        }
        .k-grid-header th.k-header{
            text-overflow: ellipsis;
    text-align: center;
    text-transform: none;
    font-size: 0.75rem;
    letter-spacing: 1px;
    font-weight: 500;
        }
        .k-pager-info {
    float: right;
    text-transform: none;
    font-size: 0.75rem;
    letter-spacing: 1px;
    font-weight: 500;
    padding: 0 1.333em;
}
        .k-pager-sizes {
    display: inline-block;
    padding-top: 1px;
    text-transform: none;
    font-size: 0.90rem;
    letter-spacing: 1px;
    font-weight: 500;
}
         .k-footer{
             background-color: #fff;
        }
 .k-widget{
      background-color: #fff;
 }
        .k-header {
        background-color: #fff;
        }
        .k-grid td {
    white-space: nowrap;
    background-color: #eceef1;
    border-color: inherit;
    /* text-align: center; */
}
        
    .k-state-selected {
        color: #000;
        border-color: inherit;
    }

</style>
<link rel="stylesheet" href="styles/kendo.common.min.css" />
<link rel="stylesheet" href="styles/kendo.default.min.css" />
<link rel="stylesheet" href="styles/kendo.default.mobile.min.css" />

@*<script src="js/jquery.min.js"></script>*@

<script src="js/jszip.min.js"></script>

<script src="js/kendo.all.min.js"></script>
@*<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha384-tsQFqpEReu7ZLhBV2VZlAu7zcOV+rXbYlF2cqB8txI/8aZajjp4Bqd+V6D5IgvKT" crossorigin="anonymous">
    </script>*@

@*<script src="js/xlsx.core.min.js"></script>
    <script src="js/FileSaver.js"></script>

    <script src="js/jhxlsx.js"></script>*@

<html>

<body class="hold-transition skin-blue sidebar-mini fixed">
    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper" >
        <!-- Main content -->
    
        <div class="container-xxl flex-grow-1 container-p-y">
            <div class="card-body" style="margin-top:-9px;">
                <h5 class="mobile-card-header">Physical Storage</h5>
                <form id="formAccountSettings" method="POST" onsubmit="return false">
                    <div class="row" id="header" style="margin-bottom:10px">
                        <div class="col-sm-3" style="width: 23.5%;">
                            <label class="form-label" for="subCatgery">Document Type&nbsp;<span style="font-size: 12px;color: red;font-weight: bold;">*</span></label>
                            <select id="subCatgery" name="subCatgery" onchange="fetchDocName()" class="form-select"></select>
                            <span class="errormessage" id="erridmsg"></span>
                        </div>
                        <div class="col-sm-3" style="width: 23.5%;">
                            <label class="form-label" for="Catgery">Document Group&nbsp;<span style="font-size: 12px;color: red;font-weight: bold;">*</span></label>
                            <select id="Catgery" name="Catgery" onchange="fetchDocGroup()" class="form-select"></select>
                            <span class="errormessage" id="erridmsg"></span>
                        </div>
                        <div class="col-sm-3" style="width:23.5%">
                            <label class="form-label" for="From_date">Archival Date From&nbsp;<span style="font-size: 12px;color: red;font-weight: bold;">*</span></label>
                            <input type="date" id="From_date" class="form-control" placeholder="">
                        </div>
                        <div class="col-sm-3" style="width:23.5%">
                            <label class="form-label" for="To_date">Archival Date To&nbsp;<span style="font-size: 12px;color: red;font-weight: bold;">*</span></label>
                            <input type="date" id="To_date" class="form-control" placeholder="">
                        </div>
                        <div class="col-sm-3" style="width:23.5%">
                            <label class="form-label" for="docstatus">Document Status</label>
                            <select id="docstatus" class="form-select">
                                <option value="0">Select</option>
                                <option value="S">Stored</option>
                                <option value="NS">Not Stored</option>
                                <option value="All">All</option>
                            </select>
                        </div>
                        <div class="col-sm-3" style="margin-top:30px;width:11%">
                            <img src="~/Assets/images/login-refresh.png" style="float: right;margin-right: -25px;">
                            <button type="submit" data-bs-toggle="modal" id="btnapplyfilter"  data-bs-target="#applyfilter" onclick="AddAttributes()" class="btn btn-sm btn-primary me-2" style="float: right;">Apply Filter</button>
                        </div>
                    </div>

                    <div class="row" id="showresult1" style="margin-top:10px;display:none;">
                    </div>
                    <div class="row" id="showresult">
                        <div class="col-sm-12">
                            <div id="Maingrid" class="col-md-12" style="margin-top:10px">

                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>


        <!-- /.content -->
    </div>
    <button type="button" id="btnExport" style="background-color:skyblue;display:none" class="Export btn btn-sm btn-info"><span class="glyphicon glyphicon-export"></span></button>
</body>
</html>

<script type="text/javascript">
    var orglevelcode1 = "";
    var orglevelcode2 = "";
    var orglevelcode3 = "";
    var orglevelcode4 = "";
    var slno = 0;
    var UsersList;
    var mode = 'Insert';
    var Atrgid = 0;
    var ctlcount = 0;
    var loadflag = 0;

    @*function loaddynamiccolumns() {
        try {
            $.ajax({
                type: "POST",
                contentType: "application/json; charset=utf-8",
                async: false,
                url: '@Url.Action("getlabellist", "DocGroupMaster")',
                data: "{}",
                success: function (data) {
                    debugger;
                    // var orglevelcode1 = data[0].orghierarchy_code;
                    maxorglvl = data.length;
                    // alert(maxorglvl);
                    if (maxorglvl > 2) {
                        $("#sct1").show();
                        $("#sct2").hide();
                    } else {
                        $("#sct2").show();
                        $("#sct1").hide();
                    }
                    if (data.length >= 1) {
                        orglevelcode1 = data[0].orghierarchy_code;
                        var org1val = data[0].orghierarchy_name;
                        if (orglevelcode1 != null && orglevelcode1 != "" && orglevelcode1 != "undefined") {
                            $("#orglvl1lbl").text(org1val);
                            $("#thlbl1").text(org1val);
                            //orglevelval1 = $("#" + orglevelcode1).val();
                            $("#orgcol1").show();
                            $("#thlbl1").show();

                            $.ajax({
                                url: '@Url.Action("DocGroupNames", "ConfigureAttributes")',
                                type: "GET",
                                data: { 'parentcode': orglevelcode1, "dependcode": "" },
                                success: function (data) {

                                    for (var i = 0; i < data.length; i++) {
                                        var opt = new Option(data[i].master_name, data[i].master_code);
                                        //    var opt2 = new Option(data[0].Dname_Name, data[0].Dname_Id);
                                        $('#orglvl1val').append(opt);

                                        //$("#sdocname").find('option').each(function (i, opt) {

                                        //    // if (opt.value === Draft)
                                        //    $(opt2).attr('selected', 'selected');
                                        //});

                                    }
                                }
                            });
                        }

                    }
                    if (data.length >= 2) {
                        orglevelcode2 = data[1].orghierarchy_code;
                        var org1va2 = data[1].orghierarchy_name;
                        if (orglevelcode2 != null && orglevelcode2 != "" && orglevelcode2 != "undefined") {
                            $("#orglvl2lbl").text(org1va2);
                            //   orglevelval2 = $("#" + orglevelcode2).val();
                            $("#orgcol2").show();
                            $("#thlbl2").text(org1va2);
                            $("#thlbl2").show();

                            $.ajax({
                                url: '@Url.Action("DocGroupNames", "ConfigureAttributes")',
                                type: "GET",
                                data: { 'parentcode': orglevelcode2, "dependcode": "" },
                                success: function (data) {

                                    for (var i = 0; i < data.length; i++) {
                                        var opt = new Option(data[i].master_name, data[i].master_code);
                                        //    var opt2 = new Option(data[0].Dname_Name, data[0].Dname_Id);
                                        $('#orglvl2val').append(opt);

                                        //$("#sdocname").find('option').each(function (i, opt) {

                                        //    // if (opt.value === Draft)
                                        //    $(opt2).attr('selected', 'selected');
                                        //});

                                    }
                                }
                            });
                        }
                    }
                    if (data.length >= 3) {
                        orglevelcode3 = data[2].orghierarchy_code;
                        var org1va3 = data[2].orghierarchy_name;
                        if (orglevelcode3 != null && orglevelcode3 != "" && orglevelcode3 != "undefined") {
                            $("#orglvl3lbl").text(org1va3);
                            // orglevelval3 = $("#" + orglevelcode3).val();
                            $("#orgcol3").show();
                            $("#thlbl3").text(org1va3);
                            $("#thlbl3").show();

                            $.ajax({
                                url: '@Url.Action("DocGroupNames", "ConfigureAttributes")',
                                type: "GET",
                                data: { 'parentcode': orglevelcode3, "dependcode": "" },
                                success: function (data) {

                                    for (var i = 0; i < data.length; i++) {
                                        var opt = new Option(data[i].master_name, data[i].master_code);
                                        //    var opt2 = new Option(data[0].Dname_Name, data[0].Dname_Id);
                                        $('#orglvl3val').append(opt);

                                        //$("#sdocname").find('option').each(function (i, opt) {

                                        //    // if (opt.value === Draft)
                                        //    $(opt2).attr('selected', 'selected');
                                        //});

                                    }
                                }
                            });
                        }
                    }
                    if (data.length == 4) {
                        orglevelcode4 = data[3].orghierarchy_code;
                        var org1va4 = data[3].orghierarchy_name;
                        if (orglevelcode4 != null && orglevelcode4 != "" && orglevelcode4 != "undefined") {
                            $("#orglvl4lbl").text(org1va4);
                            //orglevelval4 = $("#" + orglevelcode4).val();
                            $("#orgcol4").show();
                            $("#thlbl4").text(org1va4);
                            $("#thlbl4").show();

                            $.ajax({
                                url: '@Url.Action("DocGroupNames", "ConfigureAttributes")',
                                type: "GET",
                                data: { 'parentcode': orglevelcode4, "dependcode": "" },
                                success: function (data) {

                                    for (var i = 0; i < data.length; i++) {
                                        var opt = new Option(data[i].master_name, data[i].master_code);
                                        //    var opt2 = new Option(data[0].Dname_Name, data[0].Dname_Id);
                                        $('#orglvl4val').append(opt);

                                        //$("#sdocname").find('option').each(function (i, opt) {

                                        //    // if (opt.value === Draft)
                                        //    $(opt2).attr('selected', 'selected');
                                        //});

                                    }
                                }
                            });
                        }
                    }


                    // alert(orglevelcode1);
                    //setTimeout(function () {
                    //    window.location.reload(1);
                    //}, 2500);
                },
            });
        } catch (er) {
            alert(er);
        }
    }

    function onChangeunit(parent_code) {
        debugger;
        try {
            var mastercode = this.value();
            var master = ""
            if (mastercode == "" || mastercode == null || mastercode == "undefined" || mastercode == 0) {
                return false;
            }
            else {
                $.ajax({
                    url: '@Url.Action("DocGroupNames", "DocGroupMaster")',
                    type: "POST",
                    datatype: "json",
                    data: { 'parentcode': master,'dependcode': mastercode},
                    success: function (data) {
                        // $.getJSON("DocGroupNames/DocGroupMaster?parentcode=" + master + "&dependcode=" + mastercode, function (data) {
                        debugger;
                        var dept = data;


                        //$("#Dept_Id").data("kendoDropDownList").dataSource.data(data[1]);
                        if (dept.length > 1) {
                            var ee = data[1].parent_code;
                            //$("#" + ee).data("kendoDropDownList").dataSource.data(data);
                            $("#" + ee).data("kendoDropDownList").value(data[1].master_code);
                            //$("#" + ee).data("kendoDropDownList").select(1)
                            $("#" + ee).data("kendoDropDownList").trigger("change");

                            $("#" + ee).data("kendoDropDownList").enable(false);
                            //$("#Dept_Id").data("kendoDropDownList").refresh();
                        }
                        else {
                            var ee = data[0].parent_code;
                            //  $("#" + ee).data("kendoDropDownList").select(0)
                        }
                    }
                });
            }
        } catch (er) {
            hideProgress();
        }
    }*@
</script>
<script type="text/javascript">
    var div1 = "";
    var div2 = "";
    var div3 = "";
    var div4 = "";
    var counter = 0;
    var countdata = [];
    var atrCheck = false;
    var counter1 = 0;
    var countdata1 = [];
    var objDialog5;
    var dbCondition = "";
    var rbval = "";
    var FilterAppliedflag;
    //$("#btnExport").kendoButton({
    //    click: function () {
    //        debugger;
    //        //$("#salesreport_grid").data("kendoGrid").saveAsExcel();
    //        ExportButtonClick();
    //    }
    //});
    function ExportButtonClick1() {
        debugger;
        var docgroup = $("#CateID").val();
        var docname = $("#SubCateID").val();
        var dbCondition = "";
        window.location.href = '../BasicReport/GetIndexedFileExportDetails?DGroup=' + docgroup + '&DName=' + docname + '&dbCondition=' + dbCondition + '&action=' + "export";
    }
    $(".accordion_head").click(function () {
        if ($('.accordion_body').is(':visible')) {
            $(".accordion_body").slideUp(300);
            $(".plusminus").text('+');
        }
        if ($(this).next(".accordion_body").is(':visible')) {
            $(this).next(".accordion_body").slideUp(300);
            $(this).children(".plusminus").text('+');
        } else {
            $(this).next(".accordion_body").slideDown(300);
            $(this).children(".plusminus").text('-');
        }

    });
    var checkedIds = {};
    var objDialog;
    $(document).ready(function () {
        debugger;
        $("#navhead").text("Storage Listing");
        // $("#CateID").data("kendoDropDownList").enable(false);
        // $("#AttribID").data("kendoDropDownList").enable(false);
        $("#btnAddAttrib").attr("disabled", true);
        //$("#btnAddAttrib").removeAttr("disabled");

        objDialog = $("[id$='ForPartialView']");
        objDialog.dialog({
            autoOpen: false,
            modal: true,
            width: 550,
            height: 400
        });

        objDialog5 = $("[id$='ForAttributeDetailsPartialView']");
        objDialog5.dialog({
            autoOpen: false,
            modal: true,
            width: 1250,
            height: 680
        });

        //$('input[type=radio][name=Archival]').change(function () {
        //    if (this.value == 'Arc') {
        //        // ...
        //        $("#example").remove();
        //        rbval = "Arc";
        //    }
        //    else if (this.value == 'NArc') {
        //        // ...
        //        $("#example").remove();
        //        rbval = "NArc";

        //    }
        //});


        @*$.ajax({
            url: '@Url.Action("GetBasicReportDetails", "BasicReport")',
            type: "GET",
            data: { 'Master': "DocName" },
            success: function (data) {
                debugger;
                var value1 = data;
                for (var i = 0; i < value1.length; i++) {
                    var opt = new Option(value1[i].SubCateName, value1[i].SubCateID);
                    var opt2 = new Option(value1[0].SubCateName, value1[0].SubCateID);
                    $('#subCatgery').append(opt);
                }
            }
        });

        $.ajax({
            url: '@Url.Action("GetBasicReportDetails", "BasicReport")',
            type: "GET",
            data: { 'Master': "DocGroup" },
            success: function (data) {
                debugger;
                var value1 = data;
                for (var i = 0; i < value1.length; i++) {
                    var opt = new Option(value1[i].CateName, value1[i].CateID);
                    var opt2 = new Option(value1[0].CateName, value1[0].CateID);
                    $('#Catgery').append(opt);

                    //$("#subCatgery").find('option').each(function (i, opt) {
                    //    $(opt2).attr('selected', 'selected');
                    //});
                }
            }
        });*@

        $("#refreshFilter").click(function () {
            orderby = 0;
            counter = 0;
            countdata = [];
            $("#add_attribute_table").empty();
            AddAttributes();
        });


        $("#showcoursetable").click(function () {
            var subCatgery = $("#subCatgery").val();
            var Catgery = $("#Catgery").val();
            var orglvl4val = $("#orglvl4val").val();
            var orglvl3val = $("#orglvl3val").val();
            var orglvl2val = $("#orglvl2val").val();
            var orglvl1val = $("#orglvl1val").val();

            if (subCatgery != 0 && Catgery != 0 && subCatgery != "" && subCatgery != "undefined" && Catgery != "" && Catgery != "undefined") {

                var subCatgeryname = $("#subCatgery option:selected").text();
                var Catgeryname = $("#Catgery option:selected").text();
                var orglvl4valname = $("#orglvl4val option:selected").text();
                var orglvl3valname = $("#orglvl3val option:selected").text();
                var orglvl2valname = $("#orglvl2val option:selected").text();
                var orglvl1valname = $("#orglvl1val option:selected").text();

                slno++;
                var newRow = $("<tr>");
                var cols = "";
                cols = '<td style="background-color: #eceef1;">' + slno + '</td>';
                cols += '<td style="background-color: #eceef1;">' + subCatgeryname + '</td>';
                cols += '<td style="background-color: #eceef1;">' + Catgeryname + '</td>';
                if (orglvl4val != null && orglvl4val != "" && orglvl4val != "undefined") {
                    cols += '<td style="background-color: #eceef1;">' + orglvl4valname + '</td>';
                }
                if (orglvl3val != null && orglvl3val != "" && orglvl3val != "undefined") {
                    cols += '<td style="background-color: #eceef1;">' + orglvl3valname + '</td>';
                }
                if (orglvl2val != null && orglvl2val != "" && orglvl2val != "undefined") {
                    cols += '<td style="background-color: #eceef1;">' + orglvl2valname + '</td>';
                }
                if (orglvl1val != null && orglvl1val != "" && orglvl1val != "undefined") {
                    cols += '<td style="background-color: #eceef1;">' + orglvl1valname + '</td>';
                }
                cols += '<td align="center"><input name="default-radio-1" class="form-check-input" type="radio" value="" id="defaultRadio1" /></td>';

                newRow.append(cols);
                $("#tbodydtl").append(newRow);
            } else {
                debugger;

                if (orglvl4val == "" || orglvl4val == null || orglvl4val == "undefined") {
                    orglvl4val = 0;
                }
                if (orglvl3val == "" || orglvl3val == null || orglvl3val == "undefined") {
                    orglvl3val = 0;
                }
                if (orglvl2val == "" || orglvl2val == null || orglvl2val == "undefined") {
                    orglvl2val = 0;
                }
                if (orglvl1val == "" || orglvl1val == null || orglvl1val == "undefined") {
                    orglvl1val = 0;
                }

                $.ajax({
                    url: '@Url.Action("Headerfetch", "DocArchival")',
                    type: "GET",
                    data: { 'orglvl4val': orglvl4val, "orglvl3val": orglvl3val, "orglvl2val": orglvl2val, "orglvl1val": orglvl4val },
                    success: function (data) {
                        debugger;
                        var value1 = data;
                        for (var i = 0; i < value1.length; i++) {

                            var subCatgeryname = value1[i].SubCategory_name;
                            var Catgeryname = value1[i].Category_name;
                            var orglvl4valname = value1[i].Orglvl4name;
                            var orglvl3valname = value1[i].Orglvl3name;
                            var orglvl2valname = value1[i].Orglvl2name;
                            var orglvl1valname = value1[i].Orglvl1name;

                            slno++;
                            var newRow = $("<tr>");
                            var cols = "";
                            cols = '<td style="background-color: #eceef1;">' + slno + '</td>';
                            cols += '<td style="background-color: #eceef1;">' + subCatgeryname + '</td>';
                            cols += '<td style="background-color: #eceef1;">' + Catgeryname + '</td>';
                            if (orglvl4val != null && orglvl4val != "" && orglvl4val != "undefined") {
                                cols += '<td style="background-color: #eceef1;">' + orglvl4valname + '</td>';
                            }
                            if (orglvl3val != null && orglvl3val != "" && orglvl3val != "undefined") {
                                cols += '<td style="background-color: #eceef1;">' + orglvl3valname + '</td>';
                            }
                            if (orglvl2val != null && orglvl2val != "" && orglvl2val != "undefined") {
                                cols += '<td style="background-color: #eceef1;">' + orglvl2valname + '</td>';
                            }
                            if (orglvl1val != null && orglvl1val != "" && orglvl1val != "undefined") {
                                cols += '<td style="background-color: #eceef1;">' + orglvl1valname + '</td>';
                            }
                            cols += '<td align="center"><input name="default-radio-1" class="form-check-input" type="radio" value="" id="defaultRadio1" /></td>';

                            newRow.append(cols);
                            $("#tbodydtl").append(newRow);
                        }
                    }
                });
            }

        });

        $("#btn_transfer").click(function () {
            var subCatgery = $("#subCatgery").val();
            var Catgery = $("#Catgery").val();
            var orglvl4val = $("#orglvl4val").val();
            var orglvl3val = $("#orglvl3val").val();
            var orglvl2val = $("#orglvl2val").val();
            var orglvl1val = $("#orglvl1val").val();


            var subCatgeryname = $("#subCatgery option:selected").text();
            var Catgeryname = $("#Catgery option:selected").text();
            var orglvl4valname = $("#orglvl4val option:selected").text();
            var orglvl3valname = $("#orglvl3val option:selected").text();
            var orglvl2valname = $("#orglvl2val option:selected").text();
            var orglvl1valname = $("#orglvl1val option:selected").text();

            $("#doctype").val(subCatgeryname);
            $("#doctypecode").val(subCatgery);
            $("#subdoctype").val(Catgeryname);
            $("#subdoctypecode").val(Catgery);
            $("#orglvl4valh").val(orglvl4valname);
            $("#orglvl3valh").val(orglvl3valname);
            $("#orglvl2valh").val(orglvl2valname);
            $("#orglvl1valh").val(orglvl1valname);
        });

        $("#transfer").click(function () {
           // $("#filter").show();
        })
        $("#btnShowResult").click(function () {
            $("#showresult").show();
           // $("#showresult1").show();
        })
        getScreenAccess(45, "storage Listing");

    });

    function selects() {
        debugger;
        var checked = true;
        $('.checkbox').each(function (idx, item) {
            if (checked) {
                if (!($(item).closest('tr').is('.k-selected'))) {
                    $(item).click();
                }
            } else {
                if ($(item).closest('tr').is('.k-selected')) {
                    $(item).click();
                }
            }
        });
    }

    function Refresh() {
        debugger;
        window.location.reload(1);
    }

    function StrAttributesLoad() {
        debugger;
        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();
        var attribgid = Atrgid;

        $.ajax({
            url: '@Url.Action("ShowPopUpWindow", "PhysicalArchival")',
            data: { 'docgroup': docgroup, 'docname': docname, 'Aaction': mode, 'attribgid': attribgid },
            success: function (result) {
                debugger;
                var model = result.dept;
                UsersList = result.dept;
                $("#showresult1").empty();
                for (var i = 0; i < model.length; i++) {
                    var newRow2 = $("<div class='col-sm-2'>");
                    var newColumn2 = "";
                    var mandatory = '';
                    var modelvalue = model[i].Satrdesc;

                    if (modelvalue == null || modelvalue == "undefined" || modelvalue == "null") {
                        modelvalue = "";
                    }

                    if (i == 0) {
                        var newRow2n = $("<div class='col-sm-2' style='margin-top:25px;'>");
                        var newColumn2n = "";
                        newColumn2n += '<span style="font-size:14px;"><input class="form-check-input" type="checkbox" value="" id="datechk" onclick="selects()" />&nbsp;Select All</span>';
                        newRow2n.append(newColumn2n);
                        $("#showresult1").append(newRow2n);
                    }
                    if (model[i].SatrMand == "Y") {
                        mandatory = '<span style="font-size: 12px;color: red;font-weight: bold;">*</span>';
                    }
                    if (model[i].Satrtype == "Datetime") {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><input id="ctl' + i + '"  type="text" class="form-control" value = "' + modelvalue + '" onkeydown ="return false" >';
                    } else if (model[i].Satrtype == "Alpha Numeric") {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><input id="ctl' + i + '" type="text" value = "' + modelvalue + '" class="form-control" placeholder="">';
                    } else if (model[i].Satrtype == "Numeric") {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><input id="ctl' + i + '" type="text" value = "' + modelvalue + '" class="form-control" onkeypress = "return NumersOnly(event)" oncopy = "return false" onpaste = "return false">';
                    } else if (model[i].Satrtype == "Amount") {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><input id="ctl' + i + '" type="text" value = "' + modelvalue + '" class="form-control" onkeypress = "return isNumberKey(event)" oncopy = "return false" onpaste = "return false">';
                    } else if (model[i].Satrtype == "Logical") {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><div class="radio" style="position:relative"> <input type="radio" id="ctl' + i + '" name="ctl' + i + '" value = "Y"> Yes &nbsp;&nbsp;&nbsp;&nbsp;  <input type="radio" id="ctl' + i + '" name="ctl' + i + '" value = "N"> No</div>';
                    } else {
                        newColumn2 += '<label class="form-label" for="subvertical">' + model[i].Satrname + '&nbsp;' + mandatory + '</label><input id="ctl' + i + '" type="text" value = "' + modelvalue + '" class="form-control" placeholder="">';
                    }
                    newRow2.append(newColumn2);
                    $("#showresult1").append(newRow2);
                    if (i == (model.length - 1)) {
                        var newRow2p = $("<div class='col-sm-2' style='margin-top:25px;'>");
                        var newColumn2p = "";
                        newColumn2p += '<img src="/Assets/images/brush.png">&nbsp;&nbsp;<button type="submit" id="btn_save" onclick="return Save();" class="btn btn-sm btn-primary me-2">Update</button>';
                        newRow2p.append(newColumn2p);
                        $("#showresult1").append(newRow2p);
                    }
                    ctlcount = i;
                }

                $.each(UsersList, function (index, item) {
                    debugger;
                    var Atrtype = item.Satrtype;
                    if (Atrtype == "Datetime") {
                        $('#ctl' + i).datepicker({
                            dateFormat: "dd-mm-yy",
                            changeMonth: true,
                            changeYear: true
                        })
                        if (mode == "Edit" || mode == "Delete") {
                            $('#ctl' + i).datepicker('setDate', item.Satrdesc)

                        }
                        else {
                            $('#ctl' + i).datepicker('setDate', 'today')
                        }
                    }
                    i++;
                });
            }, error: function () {
                $.alert({
                    title: 'DMS',
                    content: 'Some error has occurred.!',
                    type: 'red',
                });
            }
        });
    }

    function ShowResult() {
        debugger;
        //var dpnm = $("#DeptID").val();
        //var uname = $("#UnitID").val();
        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();
        dbCondition = "";
    //    StrAttributesLoad();
        //var dbCondition = "";

        rbval = $("#docstatus").val();
        if (rbval == "" || rbval == null || rbval == "undefined" || rbval == 0 ) {
            $.alert({
                title: ' ',
                content: 'Please Document Status.!',
                type: 'blue',
            });
            return false;
        }
        else if (countdata1.length <= 0) {
            $.alert({
                title: ' ',
                content: 'Please add filters.!',
                type: 'blue',
            });
            return false;
        }
        else {
            for (i = 0; i < countdata1.length; i++) {
                var j = 0; j = i + 1;
                var brOpen = $("#hdnStart" + j).val();
                var atrName = $("#txtAttribute" + j).val();
                var atrCondition = $("#txtCondition" + j).val();
                var atrDatatype = $("#hdnDatatype" + j).val();
                var atrValue = $("#txtAttributeValue" + j).val();
                var atrOperand = $("#txtOperand" + j).val();
                var brClose = $("#hdnEnd" + j).val();
                if (atrOperand == "OR") {
                    // frame open bracket.
                    if (brOpen.toLowerCase() == "yes") {
                        dbCondition = dbCondition + '(';
                    }

                    //frame column name.
                    if (atrDatatype.toLowerCase() == "datetime") {
                        dbCondition = dbCondition + "str_to_date(replace(`" + atrName + "`,'/','-') ,'%d-%m-%Y')";
                    }
                    else {
                        dbCondition = dbCondition + '`' + atrName + '`';
                    }

                    // frame condition.
                    if (atrCondition.toLowerCase() == "is equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " = " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else if (atrDatatype.toLowerCase() == "numeric" || atrDatatype.toLowerCase() == "amount") {
                            dbCondition = dbCondition + ' = ' + "" + atrValue + "";
                        }
                        else {
                            dbCondition = dbCondition + ' = ' + "'" + atrValue + "'";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is not equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " != " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else if (atrDatatype.toLowerCase() == "numeric" || atrDatatype.toLowerCase() == "amount") {
                            dbCondition = dbCondition + ' = ' + "" + atrValue + "";
                        }
                        else {
                            dbCondition = dbCondition + ' != ' + "'" + atrValue + "'";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "start with") {
                        dbCondition = dbCondition + ' like ' + "'" + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "end with") {
                        dbCondition = dbCondition + ' like ' + "'" + '%' + atrValue + "'";
                    }
                    else if (atrCondition.toLowerCase() == "contains") {
                        dbCondition = dbCondition + ' like ' + "'" + '%' + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "does not contains") {
                        dbCondition = dbCondition + ' not like ' + "'" + '%' + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "is greater than") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " > " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' > ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is less than") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " < " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' < ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is greater than or equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " >= " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' >= ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is less than or equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " <= " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' <= ' + "" + atrValue + "";
                        }
                    }

                    // frame open bracket.
                    if (brClose.toLowerCase() == "yes") {
                        dbCondition = dbCondition + ')';
                    }

                    //frame operands.
                    if (countdata1.length != j && countdata1.length > j) {
                        dbCondition = dbCondition + ' ' + atrOperand + ' ';
                    }
                }
                else if (atrOperand == "AND") {
                    // frame open bracket.
                    if (brOpen.toLowerCase() == "yes") {
                        dbCondition = dbCondition + '(';
                    }

                    //frame column name.
                    if (atrDatatype.toLowerCase() == "datetime") {
                        dbCondition = dbCondition + "str_to_date(replace(`" + atrName + "`,'/','-') ,'%d-%m-%Y')";
                    }
                    else {
                        dbCondition = dbCondition + '`' + atrName + '`';
                    }

                    // frame condition.
                    if (atrCondition.toLowerCase() == "is equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " = " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else if (atrDatatype.toLowerCase() == "numeric" || atrDatatype.toLowerCase() == "amount") {
                            dbCondition = dbCondition + ' = ' + "" + atrValue + "";
                        }
                        else {
                            dbCondition = dbCondition + ' = ' + "'" + atrValue + "'";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is not equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " != " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else if (atrDatatype.toLowerCase() == "numeric" || atrDatatype.toLowerCase() == "amount") {
                            dbCondition = dbCondition + ' = ' + "" + atrValue + "";
                        }
                        else {
                            dbCondition = dbCondition + ' != ' + "'" + atrValue + "'";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "start with") {
                        dbCondition = dbCondition + ' like ' + "'" + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "end with") {
                        dbCondition = dbCondition + ' like ' + "'" + '%' + atrValue + "'";
                    }
                    else if (atrCondition.toLowerCase() == "contains") {
                        dbCondition = dbCondition + ' like ' + "'" + '%' + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "does not contains") {
                        dbCondition = dbCondition + ' not like ' + "'" + '%' + atrValue + '%' + "'";
                    }
                    else if (atrCondition.toLowerCase() == "is greater than") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " > " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' > ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is less than") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " < " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' < ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is greater than or equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " >= " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' >= ' + "" + atrValue + "";
                        }
                    }
                    else if (atrCondition.toLowerCase() == "is less than or equal to") {
                        if (atrDatatype.toLowerCase() == "datetime") {
                            dbCondition = dbCondition + " <= " + "str_to_date(" + "'" + atrValue + "'" + " ,'%d-%m-%Y')";
                        }
                        else {
                            dbCondition = dbCondition + ' <= ' + "" + atrValue + "";
                        }
                    }

                    // frame open bracket.
                    if (brClose.toLowerCase() == "yes") {
                        dbCondition = dbCondition + ')';
                    }

                    //frame operands.
                    if (countdata1.length != j && countdata1.length > j) {
                        dbCondition = dbCondition + ' ' + atrOperand + ' ';
                    }
                }
                else {
                    continue;
                }
            }

            //for and operator
            //for (i = 0; i < countdata1.length; i++) {
            //    var j = 0; j = i + 1;
            //    var brOpen = $("#hdnStart" + j).val();
            //    var atrName = $("#txtAttribute" + j).val();
            //    var atrCondition = $("#txtCondition" + j).val();
            //    var atrDatatype = $("#hdnDatatype" + j).val();
            //    var atrValue = $("#txtAttributeValue" + j).val();
            //    var atrOperand = $("#txtOperand" + j).val();
            //    var brClose = $("#hdnEnd" + j).val();

            //    else {
            //        continue;
            //    }
            //}
        }
        GetSearch_Info(docgroup, docname, dbCondition);

        /* else {
           $.alert({
                title: ' ',
                content: 'Please add filters.!',
                type: 'blue',
            });
            return false;
        }*/ // ramya commentted on 22 Mar 22
    }

    function GetSearch_Info(dgroupID, dnameID, dbCon) {
        debugger;
        var activeflag = $("input[name='active_flag']:checked").val();

        if (activeflag == "undefined" || activeflag == "" || activeflag == null) {

            activeflag = "Y";
        }


        var from_date = $("#From_date").val();
        var to_date = $("#To_date").val();

        $.ajax({
            url: '@Url.Action("GetIndexedDocuments", "PhysicalArchival")',
            data: { 'Dgroup1': dgroupID, 'Dname1': dnameID, 'Dbcon': dbCon, 'Type': rbval, 'activeflag': activeflag, 'from_date': from_date, 'to_date': to_date },
            success: function (result) {
                debugger

                var chkval = JSON.parse(result.Data1);
                var arr = [];
                $.each(chkval, function (i, e) {
                    $.each(e, function (key, val) {
                        arr.push(val);
                    });
                });

                if (arr == "NoRecords") {
                    $.alert({
                        title: 'DMS',
                        content: 'No Records found..!',
                        type: 'blue',
                    });
                    return false;
                }

                var columns = [];
                var data = JSON.parse(result.Data1);
                var data2 = JSON.parse(result.Data2);
                var i = 0;

                var entryIndex = "entries[" + i + "]";

                for (var key in data[0]) {
                    var val = data2[0][key];

                    if (key == 'SlNo') {
                        columns.push({
                            field: entryIndex,
                            title: "Attribute Id",
                            width: '100px',
                            type: val,
                        });
                    } else if (key == 'FileName') {
                        columns.push({
                            field: entryIndex,
                            title: "File Name",
                            width: '300px',
                            type: 'string',
                        });
                    }
                    else if (val == "date") {
                        columns.push({
                            field: entryIndex,
                            title: key,
                            type: "date",
                            format: "{0: MM-dd-yyyy}",
                            //    locked: lock
                            parseFormats: "{0:MM-dd-yyyy}",
                            width: '150px'
                        });
                    } else if (val == "Amount" || val == "Numeric") {
                        columns.push({
                            field: entryIndex,
                            title: key,
                            type: "number",
                            //    locked: lock
                            width: '150px'
                        });
                    } else if (val == "Datetime") {
                        columns.push({
                            field: entryIndex,
                            title: key,
                            type: "date",
                            // format: "{0: MM/dd/yyyy}",
                            format: "{0: MM-dd-yyyy}",
                            width: '150px'
                            //    locked: lock
                            //  parseFormats: "{0:MM/dd/yyyy}",
                        });
                    }
                    else {
                        columns.push({
                            field: entryIndex,
                            title: key,
                            width: '180px',
                            type: val,
                        });
                    }
                    i = i + 1;
                    entryIndex = "entries[" + i + "]";
                }
                //columns.push({
                //    field: entryIndex + 1,
                //    title: 'Action',
                //    template: '<img src="/Assets/images/brush.png" id="EditStr" onclick="EditStrAtr()" style="height:20px;width:20px;">',
                //    filterable: false,
                //    sortable: true,
                //    editable: true,
                //    // width: '100px'
                //});
                var rows = [];
                var data1 = JSON.parse(result.Data1);

                $.each(data1, function (i, e) {
                    var entryArray = [];
                    $.each(e, function (key, val) {

                        entryArray.push(val);
                    });
                    rows.push(kendo.observable({
                        entries: entryArray
                    }));

                });

                var viewModel = kendo.observable({
                    gridRows: rows
                });

                var configuration = {
                    editable: false,
                    sortable: true,
                    scrollable: true,
                    filterable: true,
                    pagable: true,
                    resizable: true,
                    selectable: 'row',
                    pageable: {
                        pageSize: 5,
                        buttonCount: 4
                    },
                    columns: columns,
                    rows: viewModel,
                    //height: '100%',
                    dataBound: function (e) {
                        debugger;
                        $(".checkbox").bind("change", function (e) {
                            debugger;
                            var grid = $("#grid").data("kendoGrid");
                            var row = $(e.target).closest("tr");
                            var item = grid.dataItem(row[0]);
                            var GridID = item.entries[0];

                            $.ajax({
                                url: '@Url.Action("checkvalidone", "PhysicalArchival")',
                                data: { 'GridID': GridID },
                                success: function (data) {
                                    debugger;
                                    if (data == "Exist") {
                                        $.alert({
                                            title: 'DMS',
                                            content: 'Selected item is already created.!!',
                                            type: 'blue',
                                        });
                                        $(e.target).closest("tr").find("input[type='checkbox']").prop('checked', false);
                                        //$("#grid tbody input:checkbox").removeAttr("checked");
                                        return false;
                                    }
                                },
                            });
                        });
                    },
                };
                $("#example").remove();
                $('#Maingrid').append('<div id="example" class="table-responsive text-nowrap" id="chk1"><table id="grid" data-bind="source: gridRows" class="table table-sm" style="width:100%;height:auto;line-height:1em;font-size:12px;"></table></div>');
                var timeEditGrid = $("#grid").kendoGrid(configuration).data("kendoGrid");
                kendo.bind($("#grid"), viewModel);
                //autofit each column.
                var grid = $("#grid").data("kendoGrid");
                //for (var i = 0; i < grid.columns.length; i++) {
                //    grid.autoFitColumn(i);
                //}
            },
            error: function () {
                $.alert({
                    title: 'DMS',
                    content: 'Some error has occurred.!',
                    type: 'red',
                });
            }
        });
    }
    /*$("#Maingrid").kendoGrid({
        toolbar: ["excel"],
        excel: {
            fileName: "Test.xlsx",
            //proxyURL: "https://demos.telerik.com/kendo-ui/service/export",
            filterable: true
        }
    });*/
    function exportfunction(e, chkall, chkfilter, chktemp, twokendobox, gd) {
        debugger;
        e.preventDefault();
        var sdata = {};
        var detail = {};
        if (chkall == true) {
            if (sdata.griddata == "" || sdata.griddata == undefined) {
                sdata.griddata = JSON.stringify(e.sender.dataSource._data);

            }
        }

        //sdata.chkall = chkall;
        //sdata.chkfilter = chkfilter;
        //sdata.chktemp = chktemp;
        //sdata.SubTreeId = SubTreeId;
        //sdata.TreeId = TreeId;

        if (gd._data.length == 0) {
            kendoAlert('Sorry, no data found in the grid to Export');
            return false;
        }
        else {
            //var export_excel_data = ajaxcall_param("/Home/Export_Excel", JSON.stringify(sdata));
            var export_excel_data = JSON.stringify(sdata);
            if (export_excel_data != undefined) {
                var exp_excel = JSON.parse(export_excel_data);
                if (exp_excel.success == true) {
                    var pathname = window.location.pathname;
                    var url = window.location.href;
                    url = url.split("#");
                    url = url[0];
                    url = url.replace(pathname, "");
                    window.location.href = url + (exp_excel.path);
                }

                e.preventDefault();
                return false;
            }
        }
    }
    //on click of the checkbox:
    function selectRow() {
        //alert(e.value);
        debugger;
        try {
            //alert(this.value);
            var gridid = this.value;
            var grid1 = $('#' + gridid).data("kendoGrid");
            var checked = this.checked,
            row = $(this).closest("tr"),//$("input:checked", grid1.tbody).closest("tr");//$(this).closest("tr"),

            gridss = $('#' + gridid).data("kendoGrid"),
            dataItem = gridss.dataItem(row);

            debugger;
            var testArray = dataItem.entries[3] in checkedIds;
            if (testArray) {
                if (checked = false) {
                    checkedIds[dataItem.entries[3]] = false;
                } else {
                    checked = false;
                }
            } else {
                checkedIds[dataItem.entries[3]] = checked;
            }
            if (checked) {
                //-select the row
                //row.addClass("k-state-selected");
                row.addClass("k-gridtest");
            }
            else {
                //-remove selection
                //row.removeClass("k-state-selected");
                row.removeClass("k-gridtest");
            }
        } catch (e) {

        }
    }

    //on dataBound event restore previous selected rows:
    function onDataBound(e) {
        debugger
        var checked = [];
        for (var i in checkedIds) {
            if (checkedIds[i]) {
                checked.push(i);
                //row.addClass("k-state-selected");
            }
        }
        debugger
        var view = this.dataSource.view();
        for (var i = 0; i < view.length; i++) {
            if (checkedIds[view[i].entries[4]]) {
                this.tbody.find("tr[data-uid='" + view[i].uid + "']")
                //.addClass("k-state-selected")
                .addClass("k-gridtest")
                .find(".checkbox")
                .attr("checked", "checked");
            }
        }


    }

    function View(type) {
        debugger;
        var grid;

        grid = $("#" + type).data("kendoGrid");
        model = grid.dataItem($(event.target).closest("tr"));
        $("#hdn_filegid").val("");
        //filegid = (model.entries[2]);
        filegid = (model.entries[4]);
        $("#hdn_filegid").val(filegid);
        var mode = type;
        window.location.href = '../BasicReport/ShowIndexedDocDetailsPartialVw?filegid=' + filegid + '&modetype=' + mode;
        //objDialog5.load('../BasicReport/ViewIndexedDocDetails?filegid=' + filegid);
        //objDialog5.dialog({ title: 'Archival Details' });
        //objDialog5.dialog("open");

        //var grid = $("#grid").data("kendoGrid");
        //var model = grid.dataItem($(event.target).closest("tr"));
        //var id = (model.entries[4]);
        //var mode = 'V';
        //window.location.href = '../SetDocAttributes/SetDocAttributes?id=' + id + '&Action=' + mode;
    }

    @*function View(type) {
        debugger;
        var grid;
        grid = $("#grid").data("kendoGrid");
        model = grid.dataItem($(event.target).closest("tr"));
        $("#hdn_filegid").val("");
        //filegid = (model.entries[2]);
        filegid = (model.entries[4]);
        $("#hdn_filegid").val(filegid);
        var mode = type;

        @*$.ajax({
            url: '@Url.Action("Check_Document_Under_Modification", "TreeSearch")',
            type: "POST",
            datatype: "json",
            data: { 'Doc_GID': filegid },
            success: function (data) {
                debugger;
                if (data == 'Under Checker Queue') {
                    $.alert({
                        title: 'DMS',
                        content: "This document is waiting for checker approval, Please review the checker queue.!",
                        type: 'blue',
                    });
                    return false;
                }
                else {
                    objDialog5.load('../TreeSearch/ViewIndexedDocDetails?filegid=' + filegid);
                    objDialog5.dialog({ title: 'Document Details' });
                    objDialog5.dialog("open");
                }
            }
        });*@
    @*
        if (filegid != undefined || filegid != "")
            {
        objDialog5.load('../TreeSearch/ViewIndexedDocDetails?filegid=' + filegid);
        objDialog5.dialog({ title: 'Document Details' });
        objDialog5.dialog("open");
        }
    }*@

    function getFormated_filterDate(date) {   //get DD/MM/YYYY or MM/DD/YYYYY
        debugger
        if (date != "" || date != undefined) {
            var d = date.split("/");
            //return d[1] + "/" + d[0] + "/" + d[2];
            return date.replace(/(\d+[/])(\d+[/])/, '$2$1');
            //return d[0] + "-" + d[1] + "-" + d[2];

            /* const firstValentineOfTheDecade = new Date(2022, d[1], d[0]); // 1 for February
             const enUSFormatter = new Intl.DateTimeFormat('en-US');
             console.log("Date",d[2] + "-" + d[1] + "-" + d[0]);
             console.log('enUSFormatter.format(firstValentineOfTheDecade)', enUSFormatter.format(firstValentineOfTheDecade));
             return enUSFormatter.format(firstValentineOfTheDecade);*/
        }
    }

    function onClose_Popup() {
        debugger;
        atrCheck = false;
        $("#myTable").empty();
        counter = 0
        countdata = [];
    }

    function SaveAttributes() {
        debugger;
        //if (FilterAppliedflag == "Y") {
        //    $.dialog({
        //        title: ' ',
        //        content: 'Filter Already applied!',
        //        type: 'blue',
        //    });
        //    return false;
        //}
        $("#myTable1").empty();
        if (countdata.length > 0) {
            var _looclose = false;
            for (i = 0; i < countdata.length; i++) {

                var n = 0; n = i + 1;
                var aatrname = $("#drpAttributeN" + n).val();
                var aatrdatatype = aatrname.split('-');

                var drpconditionname = $('#drpCondition' + n + ' :selected').text();
                if (drpconditionname != "" && drpconditionname != "undefined" && drpconditionname != "Select Condition") {

                    aatrdatatype = aatrdatatype[1].toString();
                    if (aatrdatatype.toLowerCase() == 'numeric' || aatrdatatype.toLowerCase() == 'alpha numeric' ||
                        aatrdatatype.toLowerCase() == 'amount') {
                        var str = $("#txtAtrVal" + n).val();
                        if (str == "" || str == null || str == null) {
                            $.dialog({
                                title: ' ',
                                content: 'Please enter the filter value ' + aatrdatatype[0] + '!',
                                type: 'blue',
                            });
                            return false;
                        }
                        else if (aatrdatatype.toLowerCase() == "numeric" || aatrdatatype.toLowerCase() == "amount") {
                            if (!isNaN(str) == false) {
                                $.dialog({
                                    title: ' ',
                                    content: 'Please enter the valid numeric value for ' + aatrdatatype[0] + ' !',
                                    type: 'blue',
                                });
                                return false;
                            }
                        }
                    }
                    if (aatrdatatype.toLowerCase() == 'lov name') {
                        var ddval = $("#ddAtrVal" + n).val();
                        if (ddval == "Select" || ddval == null || ddval == undefined || ddval == "0") {
                            $.dialog({
                                title: ' ',
                                content: 'Please select the lov name' + aatrdatatype[0] + '!',
                                type: 'blue',
                            });
                            return false;
                        }
                    }
                    //else {

                    var newRow1 = $("<tr  width='100%'>");
                    var newColumn1 = "";
                    var orderby1 = countdata1.length + 1;
                    var j = 0; j = i + 1;

                    if (j == 1) {
                        newColumn1 += '<td style="width: 35%;"><input type="hidden" id="hdnStart' + orderby1 + '"/> <input type="text" id="txtAttribute' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 95%; margin: 0px;"/></td>';
                        newColumn1 += '<td style="width: 20%;"><input type="text" id="txtCondition' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width:95%;margin: 0px;"/> </td>';
                        newColumn1 += '<td style="width: 35%;"><input type="text" id="txtAttributeValue' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 95%;margin: 0px;"/><input type="hidden" id="hdnDatatype' + orderby1 + '"/> </td>';
                        newColumn1 += '<td style="width: 10%;"><input type="text" id="txtOperand' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width:100%;margin: 0px;"/><input type="hidden" id="hdnEnd' + orderby1 + '"/></td>';
                    }
                    else {
                        newColumn1 += '<td style="width: 35%;"><input type="hidden" id="hdnStart' + orderby1 + '"/><input type="text" id="txtAttribute' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 95%;margin: 0px;"/></td>';
                        newColumn1 += '<td style="width: 20%;"><input type="text" id="txtCondition' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 95%;margin: 0px;"/> </td>';
                        newColumn1 += '<td style="width: 35%;"><input type="text" id="txtAttributeValue' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 95%;margin: 0px;"/><input type="hidden" id="hdnDatatype' + orderby1 + '"/> </td>';
                        newColumn1 += '<td style="width: 10%;"><input type="text" id="txtOperand' + orderby1 + '" class="form-control" disabled style="height: 30px !important;width: 100%;margin: 0px;"/><input type="hidden" id="hdnEnd' + orderby1 + '"/></td>';
                    }

                    newRow1.append(newColumn1);
                    //  $("#myTable1").append(newRow1);
                    $("#myTable1").append(newRow1);
                    FilterAppliedflag = "Y";

                    //if (j == 1 && countdata.length == j) {
                    //    $("#hdnStart" + orderby1).val("Yes");
                    //    $("#hdnEnd" + orderby1).val("Yes");
                    //}
                    //else if (j == 1 && countdata.length > j) {
                    //    $("#hdnStart" + orderby1).val("Yes");
                    //    $("#hdnEnd" + orderby1).val("No");
                    //}
                    //else if (countdata.length == j) {
                    //    $("#hdnStart" + orderby1).val("No");
                    //    $("#hdnEnd" + orderby1).val("Yes");
                    //}
                    //else {
                    //    $("#hdnStart" + orderby1).val("No");
                    //    $("#hdnEnd" + orderby1).val("No");
                    //}

                    $("#hdnStart" + orderby1).val("Yes");
                    $("#hdnEnd" + orderby1).val("Yes");

                    //var atr_value = $("#drpAttribute" + j + ' :selected').text().split('-');
                    var atr_value = $("#drpAttributeN" + j).val().split('-');
                    var atr_condition = "";
                    if (atr_value[0].toString().toLowerCase() != "select attribute") {
                        atr_condition = atr_value[1].toString();
                    }

                    $("#txtAttribute" + orderby1).val(atr_value[0].toString());
                    $("#txtCondition" + orderby1).val($("#drpCondition" + j).val());
                    $("#hdnDatatype" + orderby1).val(atr_condition);
                    $("#txtOperand" + orderby1).val($("#drpOperand" + j).val());
                    if (atr_condition.toLowerCase() == "alpha numeric" || atr_condition.toLowerCase() == "numeric" || atr_condition.toLowerCase() == "amount") {
                        $("#txtAttributeValue" + orderby1).val($("#txtAtrVal" + j).val());
                    }
                    else if (atr_condition.toLowerCase() == "datetime") {
                        //var dtval = $("#dtpAtrVal" + j).val().toString().split('-');
                        //dtval = dtval[2].toString() + '-' + dtval[1].toString() + '-' + dtval[0].toString();
                        $("#txtAttributeValue" + orderby1).val($("#dtpAtrVal" + j).val());
                    }
                    else if (atr_condition.toLowerCase() == "lov name") {
                        $("#txtAttributeValue" + orderby1).val($("#ddAtrVal" + j).val());
                    }
                    else if (atr_condition.toLowerCase() == "logical") {
                        $("#txtAttributeValue" + orderby1).val($('input[id=rdoAtrVal' + j + ']:checked').val());
                    } else {
                        $("#txtAttributeValue" + orderby1).val($("#txtAtrVal" + j).val());
                    }
                    debugger;
                    countdata1.push(orderby1);
                    //    }


                }
                _looclose = true;
            }
            if (_looclose) {
                ShowResult();
            }
        }
        else {
            $.alert({
                title: ' ',
                content: 'Please add filters.!',
                type: 'blue',
            });
            return false;
        }
    }

    function AddAttributes() {
        debugger;
        //var dpnm = $("#DeptID").val();
        //var uname = $("#UnitID").val();
        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();
        var rowCount = $('#add_attribute_table tr').length;

        if (docgroup == "0" || docname == "0") {
            $.alert({
                title: ' ',
                content: 'Select Dropdowns.!',
                type: 'blue',
            });
            return false;
        }

        if (rowCount > 0) {
            return false;
        }
        if (atrCheck == false) {
            $.ajax({
                url: '@Url.Action("checkconfigattrib", "ConfigureAttributes")',
                type: "POST",
                datatype: "json",
                async: false,
                data: { 'DgroupID': docgroup, 'DNameID': docname },
                success: function (data) {
                    debugger;
                    if (data != null && data > 0) {
                        //var window = $("#kwindow_Filter").data("kendoWindow");
                        //window.open();
                        //window.center();
                        atrCheck = true;
                        AddNewRow();
                    }
                    else {
                        $.alert({
                            title: 'DMS',
                            content: 'There is no attributes found.!',
                            type: 'blue',
                        });
                        return false;
                    }
                }
            });
        }
        else {
            AddNewRow();
        }
    }

    function AddNewRow() {
        debugger;
        var newRow = $("<tr>");
        var newColumn = "";



        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();

        $.ajax({
            url: '@Url.Action("GetAttributes", "BasicReport")',
            type: "GET",
            async: false,
            data: { "inAction": 'Attribute', "DGroup": docgroup, "DName": docname },
            success: function (data) {
                debugger;
                for (var i = 0; i < (data.length - 1) ; i++) {
                    var opt = new Option(data[i].AttribName, data[i].AttribID);
                    var opt2 = new Option(data[0].AttribName, data[0].AttribID);
                    //$('#drpAttribute' + orderby).append(opt);
                    //$("#drpAttribute" + orderby).find('option').each(function (i, opt) {
                    //    $(opt2).attr('selected', 'selected');
                    //});

                    orderby = counter + 1;
                    var newRow = $("<tr>");
                    var newColumn = "";
                    var atr_name = data[i + 1].AttribName.split('-');
                    newColumn += '<td style="display:none"><input type="hidden" class="nr" value=' + orderby + ' id="hddn' + orderby + '"/></td>';
                    newColumn += '<td >' + orderby + '</td>';
                    //newColumn += '<td style="width: 25%;"><select id="drpAttribute' + orderby + '" class="form-select" onchange="onChange_Attribute(' + orderby + ')"> </select></td>';
                    newColumn += '<td style="width: 25%;"> <input type="text" id="drpAttribute' + orderby + '"  class="form-control" onchange="onChange_Attribute(' + orderby + ',' + data[i].AttribName + ')"  value = "' + atr_name[0] + '" /> <input type="hidden" id="drpAttributeN' + orderby + '"  class="form-control" value = "' + data[i + 1].AttribName + '" /> </td>';
                    newColumn += '<td style="width: 25%;"><select id="drpCondition' + orderby + '" name="drpCondition' + orderby + '" class="form-select"> </select></td>';
                    newColumn += '<td style="width: 25%;"><input type="text" id="txtAtrVal' + orderby + '" onkeypress="return PreventSpecialChar(event);" class="form-control" /> <input type="text" id="dtpAtrVal' + orderby + '" name="dtpAtrVal' + orderby + '" class="form-control" style="display:none;"/> <select id="ddAtrVal' + orderby + '" style="display:none;" class="form-control"> </select> <label id = "lblAtrVal' + orderby + '" style="display:none;" class="cus-lbl">&nbsp;&nbsp;&nbsp;&nbsp;<input type="radio" checked="checked" name="rdoAtrVal' + orderby + '" id="rdoAtrVal' + orderby + '" value="Yes" /> &nbsp;&nbsp;&nbsp;&nbsp; Yes &nbsp;&nbsp;&nbsp;<input type="radio"  name="rdoAtrVal' + orderby + '" id="rdoAtrVal' + orderby + '" value="No" />&nbsp;&nbsp;&nbsp;&nbsp;No</label></td>';
                    newColumn += '<td style="width: 8%;"><select id="drpOperand' + orderby + '" class="form-select"><option value="OR">OR</option><option value="AND">AND</option></select></td>';
                    //   newColumn += '<td><button type="button" class="ibtnDel btn btn-md btn-danger" style="margin-left: 10%;" ><span class="fa fa-trash"></span></button></td>';

                    countdata.push(orderby);
                    newRow.append(newColumn);
                    $("#add_attribute_table").append(newRow);
                    //                    $("#drpAttribute" + orderby).trigger(onChange_Attribute(orderby, data[i].AttribName));

                    var atr_value = atr_name;
                    var atr_condition = "";
                    var atr_lov = "";
                    if (atr_value[0].toString().toLowerCase() != "select attribute") {
                        atr_condition = atr_value[1].toString();
                        atr_lov = atr_value[2].toString()
                    }
                    var indexval = orderby;

                    $('#drpCondition' + indexval).empty();
                    $('#drpCondition' + indexval).append('<option value="' + "Select Condition" + '">' + 'Select Condition' + '</option>');
                    if (atr_condition.toLowerCase() == "alpha numeric") {
                        $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Start with" + '">' + "Start with" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "End with" + '">' + "End with" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Contains" + '">' + "Contains" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Does not contains" + '">' + "Does not contains" + '</option>');
                    }
                    else if (atr_condition.toLowerCase() == "numeric" || atr_condition.toLowerCase() == "amount" || atr_condition.toLowerCase() == "datetime") {
                        $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is greater than" + '">' + "Is greater than" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is less than" + '">' + "Is less than" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is greater than or equal to" + '">' + "Is greater than or equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is less than or equal to" + '">' + "Is less than or equal to" + '</option>');
                    }
                    else if (atr_condition.toLowerCase() == "logical" || atr_condition.toLowerCase() == "lov name" || atr_condition.toLowerCase() == "autonumber") {
                        $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
                        $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
                    }
                    HideShow_Attributes(atr_condition.toLowerCase(), indexval, atr_lov)


                    counter++;
                }
            }
        });
        counter++;
        //$("#counter").val(counter);
    }

    function onChange_Attribute(indexval) {
        debugger;

        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();
        // var atr_value = $("#drpAttribute" + indexval + ' :selected').text().split('-');
        var atr_value = drpdownvalue.split('-');
        var atr_condition = "";
        var atr_lov = "";
        if (atr_value[0].toString().toLowerCase() != "select attribute") {
            atr_condition = atr_value[1].toString();
            atr_lov = atr_value[2].toString()
        }

        $('#drpCondition' + indexval).empty();
        $('#drpCondition' + indexval).append('<option value="' + "Select Condition" + '">' + 'Select Condition' + '</option>');
        if (atr_condition.toLowerCase() == "alpha numeric") {
            $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Start with" + '">' + "Start with" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "End with" + '">' + "End with" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Contains" + '">' + "Contains" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Does not contains" + '">' + "Does not contains" + '</option>');
        }
        else if (atr_condition.toLowerCase() == "numeric" || atr_condition.toLowerCase() == "amount" || atr_condition.toLowerCase() == "datetime") {
            $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is greater than" + '">' + "Is greater than" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is less than" + '">' + "Is less than" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is greater than or equal to" + '">' + "Is greater than or equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is less than or equal to" + '">' + "Is less than or equal to" + '</option>');
        }
        else if (atr_condition.toLowerCase() == "logical" || atr_condition.toLowerCase() == "lov name" || atr_condition.toLowerCase() == "autonumber") {
            $('#drpCondition' + indexval).append('<option value="' + "Is equal to" + '">' + "Is equal to" + '</option>');
            $('#drpCondition' + indexval).append('<option value="' + "Is not equal to" + '">' + "Is not equal to" + '</option>');
        }
        HideShow_Attributes(atr_condition.toLowerCase(), indexval, atr_lov)
    }

    function HideShow_Attributes(DataType, indexval, lovID) {
        debugger;
        if (DataType == "datetime") {
            $("#txtAtrVal" + indexval).css('display', 'none');
            $("#dtpAtrVal" + indexval).css('display', 'inline');
            $("#ddAtrVal" + indexval).css('display', 'none');
            $("#lblAtrVal" + indexval).css('display', 'none');
            $('#dtpAtrVal' + indexval).datepicker({ dateFormat: "dd-mm-yy", changeMonth: true, changeYear: true })
            $('#dtpAtrVal' + indexval).datepicker('setDate', 'today')
        }
        else if (DataType == "lov name") {
            $("#txtAtrVal" + indexval).css('display', 'none');
            $("#dtpAtrVal" + indexval).css('display', 'none');
            $("#ddAtrVal" + indexval).css('display', 'inline');
            $("#lblAtrVal" + indexval).css('display', 'none');

            $('#ddAtrVal' + indexval).empty();
            $.ajax({
                url: '@Url.Action("GetAttributes", "BasicReport")',
                type: "GET",
                async: false,
                data: { "inAction": 'LOV', "Department": lovID },
                success: function (data) {
                    debugger;
                    for (var i = 0; i < data.length; i++) {
                        var opt = new Option(data[i].LovName, data[i].LovName);
                        var opt2 = new Option(data[0].LovName, data[0].LovName);
                        $('#ddAtrVal' + indexval).append(opt);
                        $("#ddAtrVal" + indexval).find('option').each(function (i, opt) {
                            $(opt2).attr('selected', 'selected');
                        });
                    }
                }
            });

        }
        else if (DataType == "logical") {
            $("#txtAtrVal" + indexval).css('display', 'none');
            $("#dtpAtrVal" + indexval).css('display', 'none');
            $("#ddAtrVal" + indexval).css('display', 'none');
            $("#lblAtrVal" + indexval).css('display', 'inline');
        }
        else {
            $("#txtAtrVal" + indexval).css('display', 'inline');
            $("#dtpAtrVal" + indexval).css('display', 'none');
            $("#ddAtrVal" + indexval).css('display', 'none');
            $("#lblAtrVal" + indexval).css('display', 'none');
        }
    }

    $("table.order-list").on("click", ".ibtnDel", function (event) {
        debugger;
        var value = $(this).closest('tr').find('td:eq(0)');

        value = value.find(".nr").val();

        if (value != counter) {
            value = value - 1;
        }
        countdata.splice(value, 1);
        $(this).closest("tr").remove();

        counter -= 1
        //$("#counter").val(counter);

    });

    function PreventSpecialChar(event) {
        debugger;
        var regex = new RegExp("^[a-zA-Z0-9]+$");
        var key = String.fromCharCode(!event.charCode ? event.which : event.charCode);
        if (!regex.test(key) && key != " ") {
            event.preventDefault();
            return false;
        }
    }

    function GetAttribParams() {
        debugger;
        return { Department: $("#DeptID").val(), Unit: $("#UnitID").val(), DGroup: $("#CateID").val(), DName: $("#SubCateID").val() }
    }

    function Downloadfile() {
        debugger;
        var grid = $("#grid").data("kendoGrid");
        var model = grid.dataItem($(event.target).closest("tr"));
        var FilePath = (model.entries[2]);
        var FileName = (model.entries[1]);
        $.ajax({
            url: '@Url.Action("CheckFileExists", "BasicReport")',
            contentType: 'application/json; charset=utf-8',
            datatype: 'json',
            data: { absolutePath: FilePath },
            type: "GET",
            success: function (data) {
                debugger;
                if (data == 'fileexists') {
                    var url = '@Url.Action("DownloadFile", "BasicReport", new { filePath = "REPLACEME", filename = "REPLACEFILENAME" })';
                    url = url.replace('REPLACEME', FilePath).replace('REPLACEFILENAME', FileName);
                    window.location.href = url.replace(/amp;/g, '');
                }
                else {
                    $.dialog({
                        title: ' ',
                        content: 'File not found.!',
                        type: 'blue',
                    });
                    return false;
                }
            }
        });
    }


    function ClearRecords() {
        debugger;
        $("#SubCateID").data("kendoDropDownList").select(0);
        $("#CateID").data("kendoDropDownList").select(0);

        $("#kgrid_report").data("kendoGrid").dataSource.data([]);
    }

    function GetParameters() {
        debugger;

        var arrModel = {};

        arrModel.CateID = $("#CateID").val();
        arrModel.SubCateID = $("#SubCateID").val();
        arrModel.Flag = "Search";
        return { modelObj: arrModel };
    }

    function error_handler(e) {
        if (e.errors) {
            var message = "Errors:\n";
            $.each(e.errors, function (key, value) {
                if ('errors' in value) {
                    $.each(value.errors, function () {
                        message += this + "\n";
                    });
                }
            });
            $.dialog({
                title: 'DMS',
                content: message,
                type: 'blue',
            });
        }
    }

    function IsDateKey(evt) {
        var charCode = (evt.which) ? evt.which : event.keyCode
        if (charCode > 31)
            return false;
        return true;
    }

    function onChangeDocName() {
        // debugger;
        var masteritemid = this.value();
        var master = "GetDocName"
        if (masteritemid == "" || masteritemid == null || masteritemid == "undefined" || masteritemid == 0) {
            return false;
        }
        else {
            $.getJSON("onChangeDropdowns/BasicReport?MasterID=" + masteritemid + "&Master=" + master, function (data) {
                // debugger;

                atrCheck = false;
                $("#myTable").empty();
                $("#myTable1").empty();
                counter = 0
                countdata = [];
                counter1 = 0;
                countdata1 = [];
                // $("#example").remove();

                var docgroupdropdown = $("#CateID").data("kendoDropDownList");


                docgroupdropdown.dataSource.data(data.lst_docgroup);

                //unitdropdown.dataSource.data(data.lst_unit);
                //deptdropdown.dataSource.data(data.lst_dept);

                //datasource for docgroup.
                if (data.lst_docgroup.length == 2) {
                    docgroupdropdown.select(1)
                }
                else {
                    docgroupdropdown.select(0)
                }
                // docgroupdropdown.trigger("change");


                if ($("#CateID").val() != 0 && $("#SubCateID").val() != 0) {
                    //$("#AttribID").data("kendoDropDownList").dataSource.read();

                    $("#CateID").data("kendoDropDownList").enable(true);
                    // $("#AttribID").data("kendoDropDownList").enable(true);
                    $("#btnAddAttrib").removeAttr("disabled");
                }
                debugger;
                if (data.lst_dept.length > 1) {
                    //  $("#QCD_mst_tHR").val($("#QCD_mst_tHR option").eq(1).val());
                    var MaxorglevelPos = $("#MaxorglevelPos").val();
                    var orglevel3 = $("#orglevel" + MaxorglevelPos).val();
                    $("#" + orglevel3).data("kendoDropDownList").value(data.lst_dept[1].mastercode);
                    $("#" + orglevel3).data("kendoDropDownList").enable(false);
                    var dropDownList = $("#" + orglevel3).getKendoDropDownList();
                    dropDownList.trigger("change");
                }
            });
        }
    }

    function onChangeDocGroup() {
        debugger;
        var masteritemid = this.value();
        var master = "GetDocGroup"
        if (masteritemid == "" || masteritemid == null || masteritemid == "undefined" || masteritemid == 0) {
            return false;
        }
        else {
            $.getJSON("onChangeDropdowns/BasicReport?MasterID=" + masteritemid + "&Master=" + master, function (data) {
                debugger;
                var docnamedropdown = $("#SubCateID").data("kendoDropDownList");
                //var unitdropdown = $("#UnitID").data("kendoDropDownList");
                //var deptdropdown = $("#DeptID").data("kendoDropDownList");

                if ($("#SubCateID").val() == "0" || $("#SubCateID").val() == null) {
                    docnamedropdown.dataSource.data(data.lst_docname);
                    //datasource for unit.
                    if (data.lst_docname.length == 2) {
                        docnamedropdown.select(1)
                    }
                    else {
                        docnamedropdown.select(0)
                    }
                    docnamedropdown.trigger("change");
                }
                //unitdropdown.dataSource.data(data.lst_unit);
                //deptdropdown.dataSource.data(data.lst_dept);

                ////datasource for unit.
                //if (data.lst_unit.length == 2) {
                //    unitdropdown.select(1)
                //}
                //else {
                //    unitdropdown.select(0)
                //}
                //unitdropdown.trigger("change");

                ////datasource for department.
                //if (data.lst_dept.length == 2) {
                //    deptdropdown.select(1)
                //}
                //else {
                //    deptdropdown.select(0)
                //}
                //deptdropdown.trigger("change");
            });

            //if ($("#DeptID").val() != 0 && $("#UnitID").val() != 0 && $("#CateID").val() != 0 && $("#SubCateID").val() != 0) {
            //    $("#AttribID").data("kendoDropDownList").dataSource.read();
            //}

        }
    }

    function onChangeUnit() {
        debugger;
        var masteritemid = this.value();
        var master = "GetUnit"
        if (masteritemid == "" || masteritemid == null || masteritemid == "undefined" || masteritemid == 0) {
            return false;
        }
        else {
            $.getJSON("onChangeDropdowns/BasicReport?MasterID=" + masteritemid + "&Master=" + master, function (data) {
                debugger;
                var docnamedropdown = $("#SubCateID").data("kendoDropDownList");
                var docgroupdropdown = $("#CateID").data("kendoDropDownList");
                var deptdropdown = $("#DeptID").data("kendoDropDownList");

                if ($("#SubCateID").val() == "0" || $("#SubCateID").val() == null) {
                    docnamedropdown.dataSource.data(data.lst_docname);
                    //datasource for unit.
                    if (data.lst_docname.length == 2) {
                        docnamedropdown.select(1)
                    }
                    else {
                        docnamedropdown.select(0)
                    }
                    docnamedropdown.trigger("change");
                }

                if ($("#CateID").val() == "0" || $("#CateID").val() == null) {
                    docgroupdropdown.dataSource.data(data.lst_docgroup);
                    //datasource for unit.
                    if (data.lst_docgroup.length == 2) {
                        docgroupdropdown.select(1)
                    }
                    else {
                        docgroupdropdown.select(0)
                    }
                    docgroupdropdown.trigger("change");
                }

                deptdropdown.dataSource.data(data.lst_dept);
                //datasource for department.
                if (data.lst_dept.length == 2) {
                    deptdropdown.select(1)
                }
                else {
                    deptdropdown.select(0)
                }
                deptdropdown.trigger("change");
            });

            //if ($("#DeptID").val() != 0 && $("#UnitID").val() != 0 && $("#CateID").val() != 0 && $("#SubCateID").val() != 0) {
            //    $("#AttribID").data("kendoDropDownList").dataSource.read();
            //}

        }
    }

    function onChangeDept() {
        debugger;
        var masteritemid = this.value();
        var master = "GetDept";
        if (masteritemid == "" || masteritemid == null || masteritemid == "undefined" || masteritemid == 0) {
            return false;
        }
        else {
            $.getJSON("onChangeDropdowns/BasicReport?MasterID=" + masteritemid + "&Master=" + master, function (data) {
                debugger;
                var docnamedropdown = $("#SubCateID").data("kendoDropDownList");
                var docgroupdropdown = $("#CateID").data("kendoDropDownList");
                var unitdropdown = $("#UnitID").data("kendoDropDownList");

                if ($("#SubCateID").val() == "0" || $("#SubCateID").val() == null) {
                    docnamedropdown.dataSource.data(data.lst_docname);
                    //datasource for unit.
                    if (data.lst_docname.length == 2) {
                        docnamedropdown.select(1)
                    }
                    else {
                        docnamedropdown.select(0)
                    }
                    docnamedropdown.trigger("change");
                }

                if ($("#CateID").val() == "0" || $("#CateID").val() == null) {
                    docgroupdropdown.dataSource.data(data.lst_docgroup);
                    //datasource for unit.
                    if (data.lst_docgroup.length == 2) {
                        docgroupdropdown.select(1)
                    }
                    else {
                        docgroupdropdown.select(0)
                    }
                    docgroupdropdown.trigger("change");
                }

                if ($("#UnitID").val() == "0" || $("#UnitID").val() == null) {
                    unitdropdown.dataSource.data(data.lst_unit);
                    //datasource for unit.
                    if (data.lst_unit.length == 2) {
                        unitdropdown.select(1)
                    }
                    else {
                        unitdropdown.select(0)
                    }
                    unitdropdown.trigger("change");
                }
            });

        }
    }

    function excelexportnew() {
        debugger;
        var docgroup = $("#CateID").val();
        var docname = $("#SubCateID").val();
        var dbCondition = "";
        // alert('ok');
        window.location.href = '../BasicReport/GetIndexedFileExportDetails?DGroup=' + docgroup + '&DName=' + docname + '&dbCondition=' + dbCondition + '&action=' + "export";
    }

    function ShowPopUp() {
        debugger;
        //    var deptid = $("#DeptID").val();
        //   var unit = $("#Unit").val();
        var docgroup = $("#CateID").val();
        var docname = $("#SubCateID").val();

        var grid = $("#grid").data("kendoGrid");
        var model = grid.dataItem($(event.target).closest("tr"));

        // Get checked row by getting the input and then the row containing the input
        var row = $("input:checked", grid.tbody).closest("tr");
        if (row.length == 0) {
            $.alert({
                title: 'DMS',
                content: 'Select records.!',
                type: 'blue',
            });
            return false;
        }
        //var gid = (model.entries[0]);
        //$("#Atrgid").val(gid);
        $("#action").val("Insert");
        var Aaction = "Insert";
        //var attribgid = gid;
        var attribgid = '0';

        objDialog.load('../PhysicalArchival/ShowPopUpWindow?docgroup=' + docgroup + '&docname=' + docname + '&Aaction=' + Aaction + '&attribgid=' + attribgid);
        objDialog.dialog({ title: 'Create' });
        objDialog.dialog("open");
        var count = $("#SatrCount").val();
        return false;
    }

    function EditStrAtr() {
        debugger;
        var docgroup = $("#Catgery").val();
        var docname = $("#subCatgery").val();
        mode = "Edit";
        var grid = $("#grid").data("kendoGrid");
        var model = grid.dataItem($(event.target).closest("tr"));
        var gid = (model.entries[0]);
        Atrgid = gid;
        StrAttributesLoad();

        @*$.ajax({
            url: '@Url.Action("checkvalidone", "PhysicalArchival")',
            data: { 'GridID': gid },
            success: function (data) {
                debugger;
                if (data == "Not Exist") {
                    $.alert({
                        title: 'DMS',
                        content: 'Please create physical Attributes than edit.!!',
                        type: 'blue',
                    });
                    return false;
                }
                else {
                    $("#Atrgid").val(gid);
                    $("#action").val("Edit");
                    $("#btn_save").val("Update")
                    var Aaction = "Edit";
                    var attribgid = gid;
                    objDialog.load('../PhysicalArchival/ShowPopUpWindow?docgroup=' + docgroup + '&docname=' + docname + '&Aaction=' + Aaction + '&attribgid=' + attribgid);
                    objDialog.dialog({ title: 'Edit' });
                    objDialog.dialog("open");
                    var count = $("#SatrCount").val();
                    return false;
                }
            },
        });*@
    }

    function Delete() {
        debugger;
        var docgroup = $("#CateID").val();
        var docname = $("#SubCateID").val();

        var grid = $("#grid").data("kendoGrid");
        var model = grid.dataItem($(event.target).closest("tr"));
        var gid = (model.entries[0]);

        $.ajax({
            url: '@Url.Action("checkvalidone", "PhysicalArchival")',
            data: { 'GridID': gid },
            success: function (data) {
                debugger;
                if (data == "Not Exist") {
                    $.alert({
                        title: 'DMS',
                        content: 'Please create physical Attributes than Delete.!!',
                        type: 'blue',
                    });
                    return false;
                }
                else {
                    $("#Atrgid").val(gid);
                    $("#action").val("Delete");
                    $("#btn_save").val("Delete")
                    var Aaction = "Delete";
                    var attribgid = gid;
                    objDialog.load('../PhysicalArchival/ShowPopUpWindow?docgroup=' + docgroup + '&docname=' + docname + '&Aaction=' + Aaction + '&attribgid=' + attribgid);
                    objDialog.dialog({ title: 'Delete' });
                    objDialog.dialog("open");
                    var count = $("#SatrCount").val();
                    return false;
                }
            },
        });
    }

    function flexcelfile_onchange() {
        debugger;
        var iframe = $('<iframe name="postiframe" id="postiframe" style="display: none"></iframe>');
        $("body").append(iframe);
        var form = $('#form1');
        var up = $('#flexcelfile').val();
        form.attr("action", "../PhysicalArchival/flexcelfile_onchange");
        form.attr("method", "post");
        form.attr("encodeing", "multipart/form-data");
        form.attr("enctype", "multipart/form-data");
        form.attr("target", "postiframe");
        form.attr("file", $('#flexcelfile').val());
        form.submit();
    }

    function Savefiles() {
        debugger;
        var Docgroup = $("#CateID").val();
        var Docname = $("#SubCateID").val();
        if (Docname == 0) {
            $.alert({
                title: 'DMS',
                content: 'Select Doc Name.!',
                type: 'blue',
            });
            return false;
        }

        if (Docgroup == 0) {
            $.alert({
                title: 'DMS',
                content: 'Select Doc Group.!',
                type: 'blue',
            });
            return false;
        }

        var attributeexcel = $('#flexcelfile').val();

        if (attributeexcel == "" || attributeexcel == null) {
            $.alert({
                title: 'DMS',
                content: 'Select Attributes Excel File.!',
                type: 'blue',
            });
            return false;
        }

        $.ajax({
            url: '@Url.Action("Validation", "PhysicalArchival")',
            type: "POST",
            data: { 'Docgroup': Docgroup, 'Docname': Docname },
            success: function (data) {
                if (data == "Success") {

                    $.alert({
                        title: 'DMS',
                        content: "File Uploaded Succesfully..!",
                        type: 'green',
                    });
                    setTimeout(function () {
                        debugger;
                        window.location.href = '../PhysicalArchival/PhysicalArchival';
                    }, 2500);
                }
                else {
                    $.alert({
                        title: 'DMS',
                        content: data,
                        type: 'red',
                    });
                    setTimeout(function () {
                        debugger;
                        window.location.href = '../PhysicalArchival/PhysicalArchival';
                    }, 2500);
                }
            },
            error: {

            }
        })
    }

    function SelectAll() {
        debugger;
        var checked = true;
        $('.checkbox').each(function (idx, item) {
            if (checked) {
                if (!($(item).closest('tr').is('.k-selected'))) {
                    $(item).click();
                }
            } else {
                if ($(item).closest('tr').is('.k-selected')) {
                    $(item).click();
                }
            }
        });
    }

    function fetchDocGroup() {
        debugger;
        var DocGroupID = $("#Catgery").val();
        if (DocGroupID == "" || DocGroupID == null || DocGroupID == "undefined" || DocGroupID == 0) {
            return false;
        }

        else {
            $.ajax({

                type: "GET",

                contentType: "application/json; charset=utf-8",
                dataType: "json",
                url: '@Url.Action("GetDocGroup", "DocArchival")',

                data: { 'DocGroupID': DocGroupID },
                success: function (data) {
                    debugger;
                    //  var value1 = data.Get_dept2;
                    //  var value2 = data.Get_Orglevel;
                    var value3 = data.Get_docname2;

                    //var length1 = value1.length;
                    //var length2 = value2.length;
                    var length3 = value3.length;

                    //var CheckDeptId = $("#DeptID").val();
                    ////if (CheckDeptId == "0") {
                    //    $('#DeptID').empty();
                    //    for (var i = 0; i < value1.length; i++) {
                    //        var opt = new Option(value1[i].Dept_Name, value1[i].Dept_Id);
                    //        var opt2 = new Option(value1[0].Dept_Name, value1[0].Dept_Id);

                    //        $('#DeptID').append(opt);
                    //    }
                    //    if (length1 == 2) {
                    //        $("#DeptID").val($("#DeptID option").eq(1).val());
                    //    }
                    ////}

                    //var CheckUnitId = $("#Unit").val();
                    ////if (CheckUnitId == "0") {
                    //    $('#Unit').empty();
                    //    for (var i = 0; i < value2.length; i++) {
                    //        var opt = new Option(value2[i].unit_name, value2[i].unit_id);
                    //        var opt2 = new Option(value2[0].unit_name, value2[0].unit_id);

                    //        $('#Unit').append(opt);

                    //    }
                    //    if (length2 == 2) {
                    //        $("#Unit").val($("#Unit option").eq(1).val());
                    //    }
                    ////}

                    var CheckDocNameId = $("#subCatgery").val();
                    //if (CheckDocNameId == "0") {
                    $('#subCatgery').empty();
                    for (var i = 0; i < value3.length; i++) {
                        var opt = new Option(value3[i].Dname_Name, value3[i].Dname_Id);
                        var opt2 = new Option(value3[0].Dname_Name, value3[0].Dname_Id);

                        $('#subCatgery').append(opt);

                    }
                    if (length3 == 2) {
                        $("#subCatgery").val($("#subCatgery option").eq(1).val());
                    }
                    //}

                }
            });
        }
    }


    function fetchDocName() {
        debugger;
        var DocNameId = $("#subCatgery").val();
        if (DocNameId == "" || DocNameId == null || DocNameId == "undefined" || DocNameId == 0) {
            return false;
        }

        else {
            $.ajax({
                type: "GET",

                contentType: "application/json; charset=utf-8",
                dataType: "json",
                url: '@Url.Action("GetDocName", "DocArchival")',

                data: { 'DocNameId': DocNameId },
                success: function (data) {

                    debugger;
                    //   var value1 = data.Get_dept3;
                    var value2 = data.Get_Orglevel;
                    var value3 = data.Get_docgroup3;

                    //  var length1 = value1.length;
                    var length2 = value2.length;
                    var length3 = value3.length;


                    var CheckDocGroupId = $("#Catgery").val();
                    //if (CheckDocGroupId == "0") {
                    $('#Catgery').empty();
                    for (var i = 0; i < value3.length; i++) {
                        var opt = new Option(value3[i].Dgroup_Name, value3[i].Dgroup_Id);
                        var opt2 = new Option(value3[0].Dgroup_Name, value3[0].Dgroup_Id);

                        $('#Catgery').append(opt);

                    }
                    if (length3 == 2) {
                        $("#Catgery").val($("#Catgery option").eq(1).val());
                    }
                    if (length2 == 2) {
                        //  $("#QCD_mst_tHR").val($("#QCD_mst_tHR option").eq(1).val());

                        var orglvlid = "";
                        if (maxorglvl == 4) {
                            orglvlid = "orglvl4val";
                        } else if (maxorglvl == 3) {
                            orglvlid = "orglvl3val";
                        } else if (maxorglvl == 2) {
                            orglvlid = "orglvl2val";
                        } else if (maxorglvl == 1) {
                            orglvlid = "orglvl1val";
                        }


                        $("#" + orglvlid).empty();
                        var optsel = new Option("select", "select");

                        $("#" + orglvlid).append(optsel);
                        var opt = new Option(value2[1].master_name, value2[1].master_code);

                        $("#" + orglvlid).append(opt);
                        $("#" + orglvlid).val($("#" + orglvlid + " option").eq(1).val()).change();

                        //var MaxorglevelPos = $("#MaxorglevelPos").val();
                        //var orglevel3 = $("#orglevel" + MaxorglevelPos).val();
                        //$("#" + orglevel3).data("kendoDropDownList").value(value2[1].master_code);
                        //var dropDownList = $("#" + orglevel3).getKendoDropDownList();
                        //dropDownList.trigger("change");
                    }
                    //}

                }
            });
        }
    }

    function onChangeunit(sel, idval) {
        //    alert(this.value());
        debugger;
        var id = idval;
        // alert(idval);

        try {

            var mastercode = sel.value;
            var master = ""
            if (mastercode == "" || mastercode == null || mastercode == "undefined" || mastercode == 0) {
                return false;
            }
            else {
                debugger;
                $.getJSON("DocGroupNames/DocGroupMaster?parentcode=" + master + "&dependcode=" + mastercode, function (data) {
                    debugger;
                    var dept = data;
                    // maxorglvl = dept.length;

                    //$("#Dept_Id").data("kendoDropDownList").dataSource.data(data[1]);
                    if (dept.length > 1) {
                        var ee = data[1].parent_code;

                        $("#" + idval).empty();
                        //   for (var i = 0; i < dept.length; i++) {
                        var selopt = new Option("select", "select");
                        $("#" + idval).append(selopt);
                        var opt = new Option(data[1].master_name, data[1].master_code);
                        //    var opt2 = new Option(value3[0].Dgroup_Name, value3[0].Dgroup_Id);

                        $("#" + idval).append(opt);
                        //     }
                        $("#" + idval).val($("#" + idval + " option").eq(1).val()).change();
                        ////$("#" + ee).data("kendoDropDownList").dataSource.data(data);
                        //$("#" + ee).data("kendoDropDownList").value(data[1].master_code);
                        ////$("#" + ee).data("kendoDropDownList").select(1)
                        // $("#" + ee).data("select").trigger("change");
                        //$("#Dept_Id").data("kendoDropDownList").refresh();
                    }
                    else {
                        var ee = data[0].parent_code;
                        //  $("#" + ee).data("kendoDropDownList").select(0)
                    }

                });
            }
        } catch (er) {
            hideProgress();
        }
    }
    function clearfilter() {
        debugger;
        FilterAppliedflag = "N";
        $("#myTable1").empty();
    }



    function Save() {
        debugger;
        var person = {};
        person.SatrCount = ctlcount;
        person.Atrgid = Atrgid;
        person.action=mode;
        person.activeflag = "Y";

       // var mode=$("#action").val();

      @*var UsersList = @Html.Raw(Json.Encode(@Model.dept))*@
     //   var count = $("#ctlcount").val();

        var ret = 0;
        var Dyntextvalues = [];
        var i = 0;

        $.each(UsersList, function (index, item) {
            debugger;

            var Atrtype = item.Satrtype;
            var Atrlength = item.Satrlen;
            var Atrmandotry = item.SatrMand;

            if (Atrtype == "Logical") {
                var gettxtdesval = $('input[id=ctl' + i + ']:checked').val()
                if (Atrmandotry == "Y") {
                    if (gettxtdesval == undefined) {
                        $.alert({
                            title: 'DMS',
                            content: item.Satrname + ' ' + 'field must have some input because it is mandtory field.!',
                            type: 'blue',
                        });

                        return false;
                    }
                    else {
                        Dyntextvalues.push(gettxtdesval);
                    }
                }
                else {
                    if (gettxtdesval == undefined) {
                        gettxtdesval = "";
                        Dyntextvalues.push(gettxtdesval);
                    }
                    else {
                        Dyntextvalues.push(gettxtdesval);
                    }
                }

            }
            else {
                var gettxtdesval = $('#ctl' + i).val();
                Dyntextvalues.push(gettxtdesval);
                var findtxtlen = gettxtdesval.length;
            }

            if (Atrtype == "Alpha Numeric") {
                if (findtxtlen > Atrlength) {
                    $.alert({
                        title: 'DMS',
                        content: item.Satrname + ' ' + 'field length should not be greater then' + ' ' + Atrlength,
                        type: 'blue',
                    });

                    ret = 0;
                    return false;

                }
            }

            if (Atrmandotry == "Y") {
                if (gettxtdesval == "") {
                    $.alert({
                        title: 'DMS',
                        content: item.Satrname + ' ' + 'field must have some input because it is mandotry field.!',
                        type: 'blue',
                    });

                    ret = 0;
                    return false;
                }

                if (Atrtype == "Datetime") {
                    var isDate = (new Date(gettxtdesval) !== "Invalid Date")
                    if (isDate == false) {
                        $.alert({
                            title: 'DMS',
                            content: 'Please enter the date value into' + ' ' + item.Satrname + ' ' + 'field because it is datetime type.!',
                            type: 'blue',
                        });

                        ret = 0;
                        return false;
                    }
                }
            }
            i++;
            ret = 1;
        });

        var postData = " form : [ "
        $.each(Dyntextvalues, function (index, item) {
            debugger;
            if (index == Dyntextvalues.length - 1) {
                postData = postData + "'" + Dyntextvalues[index] + "'";
            } else {
                postData = postData + "'" + Dyntextvalues[index] + "',";
            }
        });
        postData = postData + "]";

        var attribid = Atrgid;
        var cmd = mode;
        var grid = $("#grid").data("kendoGrid");
        var attachid = [];
        if(cmd=="Insert")
        {
            var row = $("input:checked", grid.tbody).closest("tr");
            //var checked=row.length;
            for (var i = 0; i < row.length; i++) {
                var item = grid.dataItem(row[i]);
                var GridID = item.entries[0];
                attachid.push(GridID);
            }

            var griddata = " form1 : [ "
            $.each(attachid, function (index, item) {
                debugger;
                if (index == row.length - 1) {
                    griddata = griddata + "'" + attachid[index] + "'";
                } else {
                    griddata = griddata + "'" + attachid[index] + "',";
                }
            });
            griddata = griddata + "]";

        }
        else
        {
            attachid.push(attribid);

            var griddata = " form1 : [ "
            $.each(attachid, function (index, item) {
                debugger;
                griddata = griddata + "'" + attachid[index] + "'";
            });
            griddata = griddata + "]";
        }
        if(mode=="Insert"||mode=="Edit")
        {
            if (ret == "1" || UsersList.length == "0") {
                debugger;
                $.ajax({
                    type: "POST",
                    cache: false,
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    url: '@Url.Action("Save", "PhysicalArchival")',
                    data: '{modelObj: ' + JSON.stringify(person) + ',' + postData + ',' + griddata + '}',
                    success: function (data) {
                        debugger;
                        mode = "Insert";
                        Atrgid = 0;
                        if (data.status == 1) {
                            $.alert({
                                title: 'DMS',
                                content: 'Storage Attributes saved successfully.!',
                                type: 'green',
                            });
                            setTimeout(function () {
                                //window.location.reload(1);
                               // Close();
                                ShowResult();
                            }, 500);
                        }
                        if (data.status == 2) {
                            $.alert({
                                title: 'DMS',
                                content: 'Storage Attributes Updated successfully.!',
                                type: 'green',
                            });
                            setTimeout(function () {
                            //    Close();
                                //CheckUserInputs();
                                ShowResult();
                            }, 500);
                        }
                    },
                    error: function () {
                    }
                });
            }

        }
        if(mode=="Delete")
        {
            $.confirm({
                icon: 'fa fa-warning',
                title: 'DMS',
                autoClose: 'cancel|10000',
                theme: 'dark',
                animationSpeed: 700,
                content: 'Are you sure do you want to delete this record!',
                type: 'orange',
                buttons: {
                    confirm: function () {
                        if (ret == "1" || UsersList.length == "0") {
                            debugger;
                            $.ajax({
                                type: "POST",
                                cache: false,
                                contentType: "application/json; charset=utf-8",
                                dataType: "json",
                                url: '@Url.Action("Save", "PhysicalArchival")',
                                data: '{modelObj: ' + JSON.stringify(person) + ',' + postData + ',' + griddata + '}',
                                success: function (data) {
                                    debugger;
                                    if (data.status == 3) {
                                        $.alert({
                                            title: 'DMS',
                                            content: 'Storage Attributes Deleted successfully.!',
                                            type: 'green',
                                        });
                                        setTimeout(function () {
                                          //  Close();
                                            // CheckUserInputs();
                                            ShowResult();
                                            //window.location.reload(1);
                                        }, 500);
                                    }

                                },
                                error: function () {
                                }
                            });
                        }
                    },
                    cancel: function () {
                        $.alert({
                            icon: 'fa fa-success',
                            title: 'DMS',
                            theme: 'dark',
                            content: 'Delete Canceled.!',
                            type: 'blue',
                            animationSpeed: 700,
                        });
                    },
                }
            });

        }

    }

    function isNumberKey(evt) {
        debugger;
        var charCode = (evt.which) ? evt.which : evt.keyCode;
        if (charCode != 46 && charCode > 31
          && (charCode < 48 || charCode > 57))
            return false;
        return true;
    }

    function NumersOnly(evt) {
        debugger;
        if (evt.keyCode == '9' || evt.keyCode == '16') {
            return;
        }
        evt.keyCode
        var code;
        if (evt.keyCode) code = evt.keyCode;
        else if (evt.which) code = evt.which;
        if (evt.which == 46)
            return false;
        if (code == 8 || code == 46)
            return true;
        if (code < 48 || code > 57)
            return false;
    }

    function load_doctype(_sel) {
        loadflag = 1;
        debugger;
        var org1condition = getconcatval($('#orglvl1valO').val());
        var org2condition = getconcatval($('#orglvl2valO').val());
        var org3condition = getconcatval($('#orglvl3valO').val());
        var org4condition = getconcatval($('#orglvl4valO').val());

        if (org1condition != "" || org2condition != "" || org3condition != "" || org4condition != "") {
            $.ajax({
                url: '@Url.Action("DepartmentEditNew", "DocArchival")',
                type: "GET",
                data: { 'type': _sel, "condition_1": org1condition, "condition_2": org2condition, "condition_3": org3condition, "condition_4": org4condition },
                success: function (data) {
                    debugger;
                    var value1 = data.dept;
                    if (_sel == 'CAT') {
                        for (var i = 0; i < value1.length; i++) {
                            var opt = new Option(value1[i].Dgroup_Name, value1[i].Dgroup_Id);
                            var opt2 = new Option(value1[0].Dgroup_Name, value1[0].Dgroup_Id);
                            $('#Catgery').append(opt);
                        }
                    } else {
                        for (var i = 0; i < value1.length; i++) {
                            var opt = new Option(value1[i].Dname_Name, value1[i].Dname_Id);
                            var opt2 = new Option(value1[0].Dname_Name, value1[0].Dname_Id);
                            $('#subCatgery').append(opt);
                        }
                    }

                }, error: function (error) {
                    alert(error);
                }
            });
        }


    }
    function getScreenAccess(screenID, screenName) {
        debugger;
        var result_;
        $.ajax({
            // type: "POST",
            contentType: "application/json; charset=utf-8",
            //   async: false,
            url: '@Url.Action("getScreenData", "UserGroupsMapping")',
            data: { 'screen_id': screenID, 'screen_name': screenName },
            success: function (data) {
                debugger;
                //  var grid = $("#kdropdownwindow").data("kendoGrid");

                var data1 = JSON.parse(data.Data1);
                if (data1[0].add_perm == "1" || data1[0].mod_perm == "1") {
                    debugger;

                }
                else if (data1[0].inactivate_perm == "1") {
                    $("#btnapplyfilter").attr('disabled', true);
                    $("#btnapplyfilter").prop('disabled', true);
                }

                else if (data1[0].view_perm == "1") {
                    $("#btnapplyfilter").attr('disabled', true);
                }

                else if (data1[0].deny_perm == "1") {
                    debugger;
                    $("#btnapplyfilter").attr('disabled', true);
                    $("#btnapplyfilter").prop('disabled', true);

                }
                else {
                    debugger;
                    $("#btnapplyfilter").attr('disabled', true);
                }
                // Getsummary();
                //for (var i = 0; i < grid.columns.length; i++) {
                //    if (i != grid.columns.length) {
                //        grid.autoFitColumn(i);  //autofit each column.

                //    }
                //}
            },
            error: function (data) {

                debugger;
            }
        });
    }

    $(document).ajaxStop(function () {
        // $('#loader').hide();
        // alert('hi');
        if (loadflag == 0) {
            load_doctype('SUBCAT');
            load_doctype('CAT');
        }
        //hideProgress();
    });
</script>